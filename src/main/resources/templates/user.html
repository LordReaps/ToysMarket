<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è - ToysMarket</title>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" />
    <link rel="stylesheet" th:href="@{/css/header_style.css}" />
    <style>
        .card {
            height: 80%; /* –í—ã—Å–æ—Ç–∞ –∫–∞—Ä—Ç–æ—á–∫–∏ ‚Äî 80% –æ—Ç —Ä–æ–¥–∏—Ç–µ–ª—å—Å–∫–æ–≥–æ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ */
        }

        /*–ß—Ç–æ–±—ã –æ–ø–∏—Å–∞–Ω–∏–µ –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–ª–æ—Å—å 2-–º—è —Å—Ç—Ä–æ–∫–∞–º–∏ –∏ –∑–∞–∫–∞–Ω—á–∏–≤–∞–ª–æ—Å—å –º–Ω–æ–≥–æ—Ç–æ—á–∏–µ–º*/
        .fixed-two-lines-desc {
            height: 2.4em; /* –í—ã—Å–æ—Ç–∞ 2 —Å—Ç—Ä–æ–∫–∏ */
            line-height: 1.2em; /* –í—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .fixed-two-lines-name {
            height: 2.4em; /* –í—ã—Å–æ—Ç–∞ 2 —Å—Ç—Ä–æ–∫–∏ */
            line-height: 1.2em; /* –í—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ */
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        .fixed-one-line-author {
            height: 1.2em; /* –í—ã—Å–æ—Ç–∞ 2 —Å—Ç—Ä–æ–∫–∏ */
            line-height: 1.2em; /* –í—ã—Å–æ—Ç–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–∏ */
            display: -webkit-box;
            -webkit-line-clamp: 1;
            -webkit-box-orient: vertical;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
        .square-image-container {
            width: 100%;
            height: 300px; /* –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –≤—ã—Å–æ—Ç–∞ ‚Äî –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω–∏—Ç—å –ø–æ–¥ –Ω—É–∂–Ω—ã–π —Ä–∞–∑–º–µ—Ä */
            position: relative;
            overflow: hidden;
            border-radius: 8px; /* –ù–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –Ω–æ —É–ª—É—á—à–∞–µ—Ç –≤–Ω–µ—à–Ω–∏–π –≤–∏–¥ */
            display: flex;
            align-items: center;
        }

        /* –°—Ç–∏–ª–∏ –¥–ª—è –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–≥–æ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è */
        .img-square {
            width: 100%;
            height: 100%;
            border-radius: 8px;
            object-fit: cover; /* –ó–∞–ø–æ–ª–Ω—è–µ—Ç –≤—Å—ë –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–æ, —Å–æ—Ö—Ä–∞–Ω—è—è –ø—Ä–æ–ø–æ—Ä—Ü–∏–∏ */
        }
    </style>
</head>
<body>

<div th:insert="~{blocks/header :: header}"></div>

<div class="container mt-4">
    <h2>–ü—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h2>

    <div th:if="${currentUser != null}">
        <p><strong>–õ–æ–≥–∏–Ω:</strong> <span th:text="${currentUser.getLoginName}">–õ–æ–≥–∏–Ω</span></p>
        <p><strong>–ü–æ—á—Ç–∞:</strong> <span th:text="${currentUser.getUsername}">–ü–æ—á—Ç–∞</span></p>
        <p th:if="${currentUser.getUserPlace != null}"><strong>–ì–æ—Ä–æ–¥:</strong> <span th:text="${currentUser.getUserPlace}">–ì–æ—Ä–æ–¥</span></p>
    </div>

    <h3>–û–±—ä—è–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è</h3>

    <div th:if="${postCards == null or postCards.empty}">
        <p>–£ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø–æ–∫–∞ –Ω–µ—Ç –æ–±—ä—è–≤–ª–µ–Ω–∏–π</p>
    </div>

    <div th:if="${postCards != null and not postCards.empty}">
        <div class="container mt-4 d-flex justify-content-center">
            <div class="row g-4">
                <div th:each="card : ${postCards}" class = "col-md-3 mb-4">
                    <a th:href="@{/card/{id}(id=${card.getId()})}" class="text-decoration-none text-reset">
                        <div class="card h-100 shadow-sm">
                            <div class="card-body">

                                <!--–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ-->
                                <div class="square-image-container">
                                    <div>

                                        <img th:if="${card.getFirstImagePath() != null}"
                                             th:src="@{'/api/images/' + ${card.getFirstImagePath()}}"
                                             alt="–§–æ–Ω —Ç–æ–≤–∞—Ä–∞"
                                             class="img-square"
                                             style="opacity: 0.3; position: absolute;
                                            top: 0; left: 0; width: 100%; height: 100%;
                                            object-fit: cover; z-index: 0;
                                            filter: blur(17px);
                                            "
                                        />

                                        <img th:if="${card.getFirstImagePath() != null}"
                                             th:src="@{'/api/images/' + ${card.getFirstImagePath()}}"
                                             alt="–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞"
                                             class="img-square"
                                             style="position: relative; z-index: 1;"
                                        />

                                    </div>
                                </div>

                                <!--–ù–∞–∑–≤–∞–Ω–∏–µ-->
                                <h5 class="card-title fixed-two-lines-name ps-3 pe-3 mb-0 mt-2" th:text="${card.getCard_name()}"></h5>

                                <!--–¶–µ–Ω–∞-->
                                <p class="mb-0 ps-3 pe-3">
                                    <strong><span style="font-size: 1.5rem; color: #4CAF50;" th:text="${card.getCard_price()}"></span></strong>
                                    <strong><span style="font-size: 1.4rem; color: #4CAF50;">‚ÇΩ</span></strong>
                                </p>

                                <!--–û–ø–∏—Å–∞–Ω–∏–µ-->
                                <p class="card-text fixed-two-lines-desc text-muted ps-3 pe-3 mb-0 mt-2 small " th:text="${card.getCard_desc()}"></p>

                                <!-- –ì–æ—Ä–∏–∑–æ–Ω—Ç–∞–ª—å–Ω–∞—è —Ç–æ–Ω–∫–∞—è —Å–µ—Ä–∞—è –ª–∏–Ω–∏—è –º–µ–∂–¥—É –û–ø–∏—Å–∞–Ω–∏–µ –∏ –ú–µ—Å—Ç–æ -->
                                <hr class="my-2" style="border-top: 2px solid #ccc; margin: 8px 16px;"/>

                                <!-- –ú–µ—Å—Ç–æ -->
                                <p  style = "font-size: 0.8rem" class="mb-0 text-muted ps-2 pe-3">üìç<span th:text="${card.getCard_place()}"></span></p>

                                <!-- –ê–≤—Ç–æ—Ä -->
                                <p class="fixed-one-line-author mb-2 pe-3 ps-3 pr-3 fw-semibold">
                                    <span style="font-size: 0.8rem; color: #4CAF50;"
                                    th:if="${authorUsers != null and authorUsers[card.id] != null}"
                                    th:text="${authorUsers[card.id].loginName}">
                                    </span>
                                    <span style="font-size: 0.8rem; color: #4CAF50;"
                                          th:if="${authorUsers == null or authorUsers[card.id] == null}"
                                          th:text="${card.getCard_author()}">
                                    </span>
                                </p>
                                <!--<a th:href="'/market/' + ${card.getId()}" class="btn btn-primary">–î–µ—Ç–∞–ª—å–Ω–µ–µ</a> -->
                            </div>
                        </div>
                    </a>
                </div>
            </div>

        </div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

</body>
</html>